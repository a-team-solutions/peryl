<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>PeRyL hsml app demo</title>
</head>

<body>
    <h1>PeRyL hsml app demo</h1>
    <div id="app"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/incremental-dom/0.6.0/incremental-dom-min.js"></script>
    <script src="../dist/umd/hsml-app.js"></script>
    <script>
        const Action = {
            title: "title",
            dec: "dec",
            inc: "inc",
            xXx: "xXx"
        }

        const state = {
            title: "Counter",
            count: 77
        };

        function view(state) {
            return [
                ["h2", [state.title]],
                ["p", [
                    "Title: ",
                    ["input",
                        {
                            type: "text",
                            name: "title",
                            value: state.title,
                            on: ["input", Action.title]
                        }
                    ],
                ]],
                ["p", [
                    ["em", ["Count"]], ": ", state.count,
                    " ",
                    ["button", { on: ["click", Action.dec, 1] }, ["-"]],
                    ["button", { on: ["click", Action.inc, 2] }, ["+"]]
                ]],
                ["p", [
                    ["button", { on: ["click", Action.xXx] }, ["xXx"]]
                ]]
            ]
        };

        function actions([action, data, event], app) {
            console.log("action:", action, data, event);
            switch (action) {
                case Action.title:
                    app.update(data);
                    break;
                case Action.inc:
                    app.update({ count: app.state.count + data });
                    setTimeout(() => app.action(Action.dec, 1), 1e3); // async call
                    break;
                case Action.dec:
                    app.update({ count: app.state.count - data });
                    break;
                default:
                    console.warn("action unhandled:", action, data);
            }
        };

        app(state, view, actions, "app");

    </script>
</body>

</html>
